<mat-card class="cart-card">
  <mat-card-title>Panier</mat-card-title>
  <mat-card-content>

    @if (cardItems().length === 0) {
      <p
        class="empty-cart"
        aria-live="polite"
      >Panier vide</p>
    } @else {

      <table mat-table [dataSource]="cardItems()" class="cart-table">
        <caption>Détail du panier</caption>
        <!-- Nom article -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef> Nom article </th>
          <td mat-cell *matCellDef="let item">
            {{ item.productItem.productName? item.productItem.productName: 'no name'  }}
          </td>
        </ng-container>

        <!-- Quantité -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef> Quantité </th>
          <td mat-cell *matCellDef="let item">
            {{ item.selectedQuantity }}
          </td>
        </ng-container>

        <!-- Prix unitaire HT -->
        <ng-container matColumnDef="unitPriceHT">
          <th mat-header-cell *matHeaderCellDef> Prix unitaire HT </th>
          <td mat-cell *matCellDef="let item">
            {{ item.unitPriceHT | currency:'EUR':'symbol':'1.2-2' }}
          </td>
        </ng-container>

        <!-- Prix unitaire TTC -->
        <ng-container matColumnDef="unitPriceTTC">
          <th mat-header-cell *matHeaderCellDef> Prix unitaire TTC </th>
          <td mat-cell *matCellDef="let item">
            {{ item.unitPriceTTC | currency:'EUR':'symbol':'1.2-2' }}
          </td>
        </ng-container>

        <!-- Taxes unitaires -->
        <ng-container matColumnDef="unitTaxes">
          <th mat-header-cell *matHeaderCellDef> Taxes unitaires </th>
          <td mat-cell *matCellDef="let item">
            {{ item.unitTaxes | currency:'EUR':'symbol':'1.2-2' }}
          </td>
        </ng-container>

        <!-- Total taxes -->
        <ng-container matColumnDef="totalTaxes">
          <th mat-header-cell *matHeaderCellDef> Total taxes </th>
          <td mat-cell *matCellDef="let item">
            {{ getItemTotalTaxes(item) | currency:'EUR':'symbol':'1.2-2' }}
          </td>
        </ng-container>

        <!-- Prix total TTC -->
        <ng-container matColumnDef="totalTTC">
          <th mat-header-cell *matHeaderCellDef> Prix total TTC </th>
          <td mat-cell *matCellDef="let item">
            {{ getItemTotalTtc(item) | currency:'EUR':'symbol':'1.2-2' }}
          </td>
        </ng-container>

        <!-- Actions -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let item">
            <button
              mat-icon-button
              color="warn"
              (click)="removeItem(item)"
              aria-label="Supprimer l'article"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <div class="cart-total">
        Total panier TTC :
        <strong>{{ totalTtc() | currency:'EUR':'symbol':'1.2-2' }}</strong>
      </div>
    }

  </mat-card-content>
</mat-card>
